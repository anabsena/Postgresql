--ANA BEATRIZ SENA DA FONTE
--FEITO EM COMPILADOR ONLINE
CREATE TABLE PRODUTO(
	ID SERIAL,
	CODIGO VARCHAR (3),
	DESCRICAO VARCHAR (100),
	UNIDADEMEDIDA VARCHAR (2),
	VALOR NUMERIC (10,2),
	CUSTO NUMERIC (10,2),
	DATACADASTRO DATE,
	INATIVO BOOLEAN
);
ALTER TABLE PRODUTO
	ADD CONSTRAINT PK_PRODUTO_ID 
	PRIMARY KEY (ID);
INSERT INTO PRODUTO 
	(CODIGO,DESCRICAO,UNIDADEMEDIDA,VALOR,CUSTO,DATACADASTRO,INATIVO)
VALUES
	('P01','Refrigerante 2L','UN',5.99, 4.00,'2022-01-10',FALSE),
	('P02','Alface','KG',0.99, 0.70,'2022-01-10',FALSE),
	('P03','Arroz 5KG','UN',19.99,18.59,'2022-01-10',FALSE),
	('P04','Feijao 1KG','UN',5.99,4.99,'2022-01-10',FALSE),
	('P05','Cerveja 600ML','UN',2.99,2.49,'2022-02-12',FALSE),
	('P06','Amendoim 500G','UN',2.50,2.00,'2022-02-12',FALSE),
	('P07','Pipoca 200G','UN',4.00,3.00,'2022-02-12',FALSE),
	('P08','Pacote Bala 1KG','UN',7.89,6.50,'2021-12-24',FALSE),
	('P09','Uva','KG',4.50,3.00,'2021-12-24',FALSE),
	('P10','Abacaxi','KG',1.99,1.50,'2021-12-24',FALSE);
ALTER TABLE PRODUTO ADD COLUMN TIPO VARCHAR(30);
UPDATE PRODUTO SET TIPO = 'Farinaceos' WHERE ID =3;
	UPDATE PRODUTO SET TIPO = 'Farinaceos' WHERE ID =4;
	UPDATE PRODUTO SET TIPO = 'Farinaceos' WHERE ID =6;
	UPDATE PRODUTO SET TIPO = 'Farinaceos' WHERE ID =7;
	UPDATE PRODUTO SET TIPO = 'Geladeira' WHERE ID = 1 OR ID = 5;
	UPDATE PRODUTO SET TIPO = 'Feira' WHERE ID IN(9,10,2);
	UPDATE PRODUTO SET TIPO = 'Doces' WHERE CODIGO = 'P08';
ALTER TABLE PRODUTO 
	ADD COLUMN QTDESTOQUE FLOAT;	
UPDATE PRODUTO SET qtdestoque = 800 WHERE ID = 1;
UPDATE PRODUTO SET qtdestoque = 2000 WHERE ID = 3;
UPDATE PRODUTO SET qtdestoque = 100 WHERE ID = 4;
UPDATE PRODUTO SET qtdestoque = 900 WHERE ID = 5;
UPDATE PRODUTO SET qtdestoque = 50 WHERE ID = 6;
UPDATE PRODUTO SET qtdestoque = 80 WHERE ID = 7;
UPDATE PRODUTO SET qtdestoque = 10 WHERE ID = 8;
UPDATE PRODUTO SET qtdestoque = 250.500 WHERE TIPO = 'Feira';
SELECT * FROM PRODUTO; 
SELECT * FROM PRODUTO WHERE VALOR > 4;
SELECT DESCRICAO,CODIGO,UNIDADEMEDIDA,VALOR 
	FROM PRODUTO 
	WHERE UNIDADEMEDIDA = 'UN';
SELECT 
	CODIGO,
	DESCRICAO,
	CAST(VALOR AS MONEY),
	CUSTO::MONEY,
	DATACADASTRO,
	TIPO
FROM PRODUTO
	WHERE DATACADASTRO >= '2022-01-01' 
		AND CUSTO < 4.00 
		AND VALOR < 10.0;
		CREATE TABLE CLIENTE (
    NOME VARCHAR(150),
    CODIGO VARCHAR (3),
    CPF VARCHAR (11),
    TELEFONE VARCHAR(11),
    DATACADASTRO DATE,
    OBSERVACOES VARCHAR(30),
    INATIVO BOOLEAN
);	
CREATE TABLE PRODUTO(
	ID SERIAL,
	CODIGO VARCHAR (3),
	DESCRICAO VARCHAR (100),
	UNIDADEMEDIDA VARCHAR (2),
	VALOR NUMERIC (10,2),
	CUSTO NUMERIC (10,2),
	DATACADASTRO DATE,
	INATIVO BOOLEAN
);
ALTER TABLE PRODUTO
	ADD CONSTRAINT PK_PRODUTO_ID 
	PRIMARY KEY (ID);
INSERT INTO PRODUTO 
	(CODIGO,DESCRICAO,UNIDADEMEDIDA,VALOR,CUSTO,DATACADASTRO,INATIVO)
VALUES
	('P01','Refrigerante 2L','UN',5.99, 4.00,'2022-01-10',FALSE),
	('P02','Alface','KG',0.99, 0.70,'2022-01-10',FALSE),
	('P03','Arroz 5KG','UN',19.99,18.59,'2022-01-10',FALSE),
	('P04','Feijao 1KG','UN',5.99,4.99,'2022-01-10',FALSE),
	('P05','Cerveja 600ML','UN',2.99,2.49,'2022-02-12',FALSE),
	('P06','Amendoim 500G','UN',2.50,2.00,'2022-02-12',FALSE),
	('P07','Pipoca 200G','UN',4.00,3.00,'2022-02-12',FALSE),
	('P08','Pacote Bala 1KG','UN',7.89,6.50,'2021-12-24',FALSE),
	('P09','Uva','KG',4.50,3.00,'2021-12-24',FALSE),
	('P10','Abacaxi','KG',1.99,1.50,'2021-12-24',FALSE);
ALTER TABLE PRODUTO ADD COLUMN TIPO VARCHAR(30);
UPDATE PRODUTO SET TIPO = 'Farinaceos' WHERE ID =3;
	UPDATE PRODUTO SET TIPO = 'Farinaceos' WHERE ID =4;
	UPDATE PRODUTO SET TIPO = 'Farinaceos' WHERE ID =6;
	UPDATE PRODUTO SET TIPO = 'Farinaceos' WHERE ID =7;
	UPDATE PRODUTO SET TIPO = 'Geladeira' WHERE ID = 1 OR ID = 5;
	UPDATE PRODUTO SET TIPO = 'Feira' WHERE ID IN(9,10,2);
	UPDATE PRODUTO SET TIPO = 'Doces' WHERE CODIGO = 'P08';
ALTER TABLE PRODUTO 
	ADD COLUMN QTDESTOQUE FLOAT;	
UPDATE PRODUTO SET qtdestoque = 800 WHERE ID = 1;
UPDATE PRODUTO SET qtdestoque = 2000 WHERE ID = 3;
UPDATE PRODUTO SET qtdestoque = 100 WHERE ID = 4;
UPDATE PRODUTO SET qtdestoque = 900 WHERE ID = 5;
UPDATE PRODUTO SET qtdestoque = 50 WHERE ID = 6;
UPDATE PRODUTO SET qtdestoque = 80 WHERE ID = 7;
UPDATE PRODUTO SET qtdestoque = 10 WHERE ID = 8;
UPDATE PRODUTO SET qtdestoque = 250.500 WHERE TIPO = 'Feira';
SELECT * FROM PRODUTO; 
SELECT * FROM PRODUTO WHERE VALOR > 4;
SELECT DESCRICAO,CODIGO,UNIDADEMEDIDA,VALOR 
	FROM PRODUTO 
	WHERE UNIDADEMEDIDA = 'UN';
SELECT 
	CODIGO,
	DESCRICAO,
	CAST(VALOR AS MONEY),
	CUSTO::MONEY,
	DATACADASTRO,
	TIPO
FROM PRODUTO
	WHERE DATACADASTRO >= '2022-01-01' 
		AND CUSTO < 4.00 
		AND VALOR < 10.0;
		CREATE TABLE CLIENTE (
    NOME VARCHAR(150),
    CODIGO VARCHAR (3),
    CPF VARCHAR (11),
    TELEFONE VARCHAR(11),
    DATACADASTRO DATE,
    OBSERVACOES VARCHAR(30),
    INATIVO BOOLEAN
);	
ALTER TABLE CLIENTE 
	ADD CONSTRAINT UK_CLIENTE_CPF 
	UNIQUE (CPF);
	
ALTER TABLE CLIENTE 
	ADD CONSTRAINT UK_CLIENTE_CODIGO 
	UNIQUE (CODIGO);
	INSERT INTO CLIENTE 
	(NOME, CODIGO, CPF, TELEFONE, DATACADASTRO, OBSERVACOES, INATIVO) 
VALUES 
    ('Maria Silva', 'C01', '12345678910', '43 34721122', '2021-12-01', 'Cliente Bom', FALSE),
    ('João Santos', 'C02', '98765432100', '43 34723020', '2021-12-01', 'Cliente Bom', FALSE),
    ('Ana Costa', 'C03', '45678912345', '43 34721152', '2022-01-14', 'Cliente Inadimplente', FALSE),
    ('Pedro Souza', 'C04', '32165498711', '43 34721011', '2022-01-14', 'Cliente Regular', FALSE),
    ('Lucas Ferreira', 'C05', '74185296300', '43 34728085', '2022-01-14', 'Cliente Regular', FALSE),
    ('Julia Oliveira', 'C06', '36925814722', '43 34722310', '2021-06-06', 'Cliente Excelente', FALSE);
  ALTER TABLE CLIENTE 
	ADD COLUMN ID SERIAL NOT NULL;
	
ALTER TABLE CLIENTE 
	ADD CONSTRAINT PK_CLIENTE_ID 
	PRIMARY KEY(ID);
SELECT * FROM CLIENTE;
SELECT * FROM CLIENTE WHERE OBSERVACOES = 'Cliente Bom';
SELECT DESCRICAO,CODIGO,UNIDADEMEDIDA,QTDESTOQUE FROM PRODUTO WHERE QTDESTOQUE > 200 AND UNIDADEMEDIDA = 'UN';
SELECT * FROM PRODUTO WHERE TIPO = 'Farinaceos';
SELECT * FROM PRODUTO WHERE TIPO = 'Farinaceos' OR TIPO = 'Feira';
SELECT DESCRICAO,CODIGO,UNIDADEMEDIDA,VALOR, CUSTO FROM PRODUTO WHERE TIPO = 'Geladeira' AND (VALOR - CUSTO) >= 1.00;
ALTER TABLE PRODUTO ADD IMPOSTO NUMERIC(10,2);
UPDATE PRODUTO SET IMPOSTO = 0.50 WHERE TIPO = 'Geladeira';
UPDATE PRODUTO SET IMPOSTO = 0 WHERE TIPO = 'Feira';
UPDATE PRODUTO SET IMPOSTO = 0.99 WHERE TIPO = 'Farinaceos';
UPDATE PRODUTO SET IMPOSTO = 0.39 WHERE TIPO = 'Doces';
SELECT CODIGO, DESCRICAO, 
       CONCAT('R$', TO_CHAR(VALOR, '999G999D99')) AS VALOR,
       CONCAT('R$', TO_CHAR(CUSTO, '999G999D99')) AS CUSTO,
       CONCAT('R$', TO_CHAR(IMPOSTO, '999G999D99')) AS IMPOSTO,
       (CUSTO + IMPOSTO) AS CUSTO_REAL,
       (VALOR - CUSTO - IMPOSTO)AS LUCRO_REAL
FROM PRODUTO;
SELECT *, to_char(DATACADASTRO, 'DD/MM/YYYY')AS NEWDATE FROM PRODUTO;
INSERT INTO PRODUTO 
    VALUES (DEFAULT,'P11', 'Caixa de Bombom 500g', 'UN', 12.99, 10.00, CURRENT_DATE, FALSE,'Doces',1000,1.50),
           (DEFAULT,'P12', 'Barra de Chocolate 1KG', 'UN', 23.99, 15.00, CURRENT_DATE, FALSE,'Doces',1400,2.89),
           (DEFAULT,'P13', 'Granulado 1KG', 'UN', 15.99, 10.00, CURRENT_DATE, FALSE,'Doces',200,2.00),
           (DEFAULT,'P14', 'Barra de Chocolate 200g', 'UN', 4.99, 1.99, CURRENT_DATE, FALSE,'Doces',4000,1.29);
SELECT * FROM PRODUTO WHERE EXTRACT(YEAR FROM DATACADASTRO) = 2023;
SELECT CODIGO, DESCRICAO, TO_CHAR(DATACADASTRO, 'DD/MM/YYYY') AS DATACADASTRO_FORMATADA FROM PRODUTO WHERE EXTRACT(YEAR FROM DATACADASTRO) = 2023;
SELECT CODIGO, DESCRICAO, IMPOSTO, 
CASE 
WHEN IMPOSTO = 0 THEN 'ISENTO'
WHEN IMPOSTO < 0.50 THEN 'IMPOSTO BAIXO'
WHEN IMPOSTO < 1.50 THEN 'IMPOSTO ALTO'
WHEN IMPOSTO >= 0.50 AND IMPOSTO <= 1.50 THEN 'IMPOSTO MEDIO'
ELSE 'NÃO INFORMADO'
END
FROM PRODUTO
